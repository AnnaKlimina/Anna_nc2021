let scrollHandler=debounce(addContentOnScroll);async function createNewsPage(){let e=document.querySelector(".main-page");e.dataset.currentPage="news-page",e.innerHTML='<div class="main-page__background"></div>\n            <h1 class="main-page__header" data-news-index="0" data-decor-index="0">Новости</h1>',await addNewsContent(),document.addEventListener("scroll",scrollHandler)}async function addNewsContent(){let e=+document.querySelector(".main-page__header").dataset.newsIndex,t=document.createElement("div");t.className="articles-grid",document.querySelector("._card-view")&&t.classList.add("_card-view"),document.querySelector(".main-page").append(t);let n,o=await fetch("https://my-library-project-server.herokuapp.com/news_content?news_index="+e+"&news_count=3");if(!o.ok)return void alert(o.status);n=await o.json();for(let e=0;e<n?.length;e++){let o=tmplNewsCard.content.cloneNode(!0);t.append(o),o=t.querySelector(".article:last-of-type"),o.querySelector(".article__link").href=n[e].link,o.querySelector(".link__image").style.backgroundImage="url("+n[e].img+")",o.querySelector(".content__link").href=n[e].link,o.querySelector(".content__header").textContent=n[e].header,o.querySelector(".content__main").textContent=n[e].content,o.querySelector(".article-footer__domain-link").href=n[e].domain_link,o.querySelector(".article-footer__domain-link").textContent=n[e].domain,o.querySelector(".article-footer__date").textContent=n[e].date}let r,a=+document.querySelector(".main-page__header").dataset.decorIndex;if(o=await fetch("https://my-library-project-server.herokuapp.com/decor_content?decor_index="+a+"&decor_count=1"),!o.ok)return void alert(o.status);r=await o.json();let c=r[0];if(a=r[1],n.length<3)return void document.removeEventListener("scroll",scrollHandler);document.querySelector(".main-page__header").dataset.newsIndex=+document.querySelector(".main-page__header").dataset.newsIndex+3,document.querySelector(".main-page__header").dataset.decorIndex=0===a?1:+document.querySelector(".main-page__header").dataset.decorIndex+1;let d=tmplNewsDecor.content.cloneNode(!0);d.querySelector(".decoration-block__picture").style.backgroundImage="url("+c.img+")",d.querySelector(".decoration-block__cite").textContent=c.cite,d.querySelector(".decoration-block__cite-resource").textContent=c.author,t.after(d)}function debounce(e){let t=!0;return function(...n){t&&(e(...n),t=!1,setTimeout((()=>{t=!0}),500))}}async function addContentOnScroll(){Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-window.pageYOffset-document.documentElement.clientHeight>200||await addNewsContent()}